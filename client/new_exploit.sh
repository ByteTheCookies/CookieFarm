#!/bin/bash

# ======= CONSTANTS =======
readonly EXPLOITS_DIR="./exploits"
readonly TEMPLATE_CONTENT='#!/usr/bin/env python3

from utils.exploiter_manager import exploit_manager

@exploit_manager
def exploit(ip: str, port: int):
    # Insert your exploit code here
    return "FAKEFLAG=="  # Return flag (or a list of flags, text containing the flags, HTML page containing the flags)


if __name__ == "__main__":
    port = 8080  # Edit with port of the service to exploit
    exploit(ip="", port=port)
'


if [ -z "$1" ]; then
    echo -e "Usage: \n $0 <exploit_name>[.py]"
    echo  "    exploit_name: Name of the exploit file to create (you can omit the extension .py)"
    exit 1
fi

exploit_name=$EXPLOITS_DIR/$1

if [[ "$exploit_name" != *.py ]]; then
    exploit_name="$exploit_name.py"
fi

mkdir -p "$(dirname "$EXPLOITS_DIR")"
touch "$exploit_name"

cat > "$exploit_name" << EOF
$TEMPLATE_CONTENT
EOF

chmod +x "$exploit_name"

echo "âœ… Created exploit file: $exploit_name"
