#!/usr/bin/env python3

from utils.exploiter_manager import exploit_manager

# ----------
import requests


@exploit_manager
def exploit(ip:str, port:int):
    flags = []

    # Service 1
    r = requests.get(f"http://{ip}:{port}/get-flag")
    flags.append(r.text)

    # Service 2
    r = requests.get(f"http://{ip}:{port}/get-flag-sleep")
    flags.append(r.text)

    # Service 3
    r = requests.get(f"http://{ip}:{port}/get-flag-somewhere")
    flags.append(r.text)

    return flags


if __name__ == "__main__":
    port = 8081                 # Edit with port of the service to exploit
    exploit(port=port)
