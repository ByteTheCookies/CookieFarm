let HOST="http://localhost:8080";async function checkConfig(){try{var e=await getConfig();if(e.error)return!1;if(!e.configured)return!1}catch(e){return console.error(e),!1}return!0}async function sendConfig(e){e=await fetch(HOST+"/api/v1/config",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({config:e})});if(!e.ok)return e.status}async function getConfig(){try{return await(await fetch(HOST+"/api/v1/config",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})).json()}catch(e){return console.error(e),{error:e.message}}}function getServiceEntries(e){return e.value.map(e=>{var[e,t]=e.value.split(":");return{name:e.trim(),port:parseInt(t,10)}}).filter(e=>e.name&&!isNaN(e.port))}function validateConfigForm(e,t){var r,n,a={team_token:e=>0<e.length,host_flagchecker:e=>0<e.length,protocol:e=>0<e.length,base_url_server:e=>/^https?:\/\/.+/.test(e),my_team_ip:e=>/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/.test(e),regex_flag:e=>{try{return new RegExp(e),!0}catch(e){return!1}},format_ip_teams:e=>/^((\d{1,3}|\{\})\.){3}(\d{1,3}|\{\})$/.test(e),range_ip_teams:e=>0<parseInt(e),max_flag_batch_size:e=>0<parseInt(e),submit_flag_checker_time:e=>0<=parseInt(e),submit_flag_server_time:e=>0<=parseInt(e)},i=e.getElementById("config-result");for([r,n]of Object.entries(a)){var s=e.getElementById(r),o=s?.value.trim();if(!o||!n(o))return s?.focus(),i.textContent="Invalid or missing: "+r.replace(/_/g," "),i.classList.add("text-red-500"),!1}a=getServiceEntries(t);return 0===a.length?(e.getElementById("services").focus(),!(i.textContent="Please provide at least one valid service (name:port)")):(e.getElementById("services-hidden").value=JSON.stringify(a),!0)}function buildConfigFromDOM(t,e){var r=e=>t.getElementById(e)?.value.trim();return{configured:!0,server:{team_token:r("team_token"),host_flagchecker:r("host_flagchecker"),protocol:r("protocol"),max_flag_batch_size:Number(r("max_flag_batch_size")),submit_flag_checker_time:Number(r("submit_flag_checker_time"))},client:{base_url_server:r("base_url_server"),submit_flag_server_time:Number(r("submit_flag_server_time")),services:getServiceEntries(e),range_ip_teams:Number(r("range_ip_teams")),format_ip_teams:r("format_ip_teams"),my_team_ip:r("my_team_ip"),regex_flag:r("regex_flag")}}}export{checkConfig,sendConfig,getConfig,getServiceEntries,validateConfigForm,buildConfigFromDOM};